var F=Object.defineProperty,R=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var _=(t,s,l)=>s in t?F(t,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[s]=l,f=(t,s)=>{for(var l in s||(s={}))O.call(s,l)&&_(t,l,s[l]);if(k)for(var l of k(s))W.call(s,l)&&_(t,l,s[l]);return t},g=(t,s)=>R(t,T(s));import{R as A,a as j,P as h,j as e,M as D,l as V,b as z,c as d,r as b,d as v,u as L,L as I,e as N,f as P,T as $,C,B as H,A as U,v as q,g as y,h as K,i as Z}from"./vendor.b8b08e03.js";const G=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function l(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=l(n);fetch(n.href,r)}};G();const x=A({key:"allMarkers",default:[]}),M=A({key:"selectedBounds",default:{_northEast:{lat:null,lng:null},_southWest:{lat:null,lng:null}}}),E=j({key:"visibleFilters",get:({get:t})=>t(x).filter(l=>l.isVisible)});var J="/bird-sightings-map/assets/marker.7f572468.png";const B=({marker:t})=>(console.log(t),e(D,{icon:new V.exports.Icon({iconUrl:J,iconSize:[35,34],iconAnchor:[12,41]}),position:[t.lat,t.lng],children:e(z,{children:d("div",{className:"flex flex-col",children:[e("div",{className:"flex flex-row",children:d("h2",{children:[e("span",{className:"font-bold",children:"Location:"})," ",t.locName]})}),e("div",{className:"flex flex-row",children:d("h2",{children:[e("span",{className:"font-bold",children:"Observed Date:"})," ",t.obsDt]})}),e("div",{className:"flex flex-row",children:d("h2",{children:[e("span",{className:"font-bold",children:"Common Name:"})," ",t.comName]})}),e("div",{className:"flex flex-row",children:d("h2",{children:[e("span",{className:"font-bold",children:"Scientific Name:"})," ",t.sciName]})})]})})},t.id));B.propTypes={marker:h.shape({id:h.node,lat:h.number,lng:h.number,locName:h.string,obsDt:h.string,comName:h.string,sciName:h.string})};const S=({isAreaSelection:t})=>{const[s,l]=b.exports.useState(null),[o,n]=v(M),r=L({areaselectstart:()=>{s&&(r.removeLayer(s),l(null))},areaselected:c=>{const i=I.rectangle(c.bounds,{color:"blue",weight:1}).addTo(r),{_bounds:a}=i;n(a),l(i)}});return b.exports.useEffect(()=>{if(!t){r.selectArea.disable();return}r.selectArea.enable(),r.selectArea.setValidate()},[t,r]),null};S.propTypes={isAreaSelection:h.bool};const X=()=>{const[t,s]=v(M),l=L({moveend:()=>{const o=l.getBounds();s(o)}});return null},Y=(t,s)=>{const[l,o]=b.exports.useState(s);return b.exports.useEffect(()=>{const n=window.matchMedia(t);o(n.matches);const r=c=>{o(c.matches)};return n.addEventListener?n.addEventListener("change",r):n.addEventListener(r),()=>n.removeEventListener?n.removeEventListener("change",r):n.removeEventListener(r)},[t]),l},Q=()=>{const[t,s]=b.exports.useState(!1),l=N(x),o=[30.266666,-97.73333],n=Y("(max-width:600px)",!0),r=i=>{if(i.isSelected)return e(B,{marker:i},i.id)};return d(P,{center:o,zoom:13,scrollWheelZoom:!0,children:[e($,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),!n&&e(C,{position:"topleft",children:e("a",{onClick:()=>s(!t),children:e("div",{"data-tip":(()=>t?"Hold the ctrl button to make a selection":"Click me to make a selection")(),className:"tooltip tooltip-right tooltip-secondary",children:e(H,{size:"30px",style:{color:"#333",backgroundColor:`${t?"#fff":"#bababa"}`}})})})}),e(C,{position:"topleft",children:e("a",{children:e("label",{htmlFor:"the-drawer",className:"drawer-button cursor-pointer",children:e(U,{size:"30px",style:{color:"#333",backgroundColor:"#fff"}})})})}),e(S,{isAreaSelection:t}),!n&&e(S,{}),n&&e(X,{}),l.map(i=>r(i))]})},ee=()=>{const t=()=>o._northEast.lat&&o._southWest.lng?e("button",{className:"btn btn-wide btn-sm",onClick:n,children:"Search"}):e("div",{"data-tip":"Make a selection in the map, then click search",className:"tooltip tooltip-secondary",children:e("button",{disabled:!0,className:"btn btn-wide btn-sm",children:"Search"})}),[s,l]=v(x),o=N(M);console.log(o);const n=()=>{console.log("searching");const r=`https://api.ebird.org/v2/data/obs/geo/recent?lat=${o._northEast.lat}&lng=${o._southWest.lng}&key=nukg96b4vofk`;fetch(r).then(c=>c.json()).then(c=>{const i=c.filter(a=>{if(a.lat<=o._northEast.lat&&a.lng<=o._northEast.lng&&a.lng>=o._southWest.lng&&a.lat>=o._southWest.lat)return a});i.forEach(a=>{a.isSelected=!0,a.isVisible=!0,a.id=q()}),l(i)})};return e("div",{className:"flex justify-center",children:t()})},te=()=>{const[t,s]=v(x),l=N(E),[o,n]=b.exports.useState(!1),r=a=>{const u=t.map((p,m)=>m===a?g(f({},p),{isSelected:!p.isSelected}):p);s(u)},c=()=>{n(!o);const a=t.map(u=>g(f({},u),{isSelected:o}));s(a)},i=a=>{const u=a.target.value;if(u==null?void 0:u.length){const p=t.map(m=>m.comName.toLowerCase().startsWith(u.toLowerCase())?g(f({},m),{isVisible:!0}):g(f({},m),{isVisible:!1}));s(p)}else{const p=t.map(m=>g(f({},m),{isVisible:!0}));s(p)}};return d(y.Fragment,{children:[e("div",{className:"form-control",children:e("input",{type:"text",placeholder:"Filter",onChange:i,className:"input input-primary input-bordered"})}),e("div",{className:"form-control",children:d("label",{className:"cursor-pointer label",children:[e("span",{className:"label-text",children:"Show/Hide All"}),e("input",{type:"checkbox",checked:!o,onChange:()=>c(),className:"toggle"})]})}),e("div",{className:"h-40 overflow-y-scroll",children:l.map((a,u)=>e("div",{className:"form-control",children:d("label",{className:"cursor-pointer label",children:[e("span",{className:"label-text",children:a.comName}),e("input",{type:"checkbox",checked:t[u].isSelected,className:"checkbox checkbox-primary",onChange:()=>r(u)})]})},a.id))})]})},se=()=>{const t=N(E);return d("div",{className:"drawer rounded-lg shadow bg-base-200 h-full",children:[e("input",{id:"the-drawer",type:"checkbox",className:"drawer-toggle"}),e("div",{className:"flex flex-col items-center justify-center drawer-content",children:e(Q,{})}),d("div",{className:"drawer-side",children:[e("label",{htmlFor:"the-drawer",className:"drawer-overlay"}),d("ul",{className:"menu p-4 overflow-y-auto w-80 bg-base-100 text-base-content",children:[e("li",{children:e("div",{children:e("h1",{className:"font-scada text-2xl text-orange-300 text-center",children:"Bird Sightings"})})}),e("li",{children:e("div",{className:"divider",children:"Search"})}),e("li",{children:e(ee,{})}),(()=>{if(t.length)return d(y.Fragment,{children:[e("li",{children:e("div",{className:"divider",children:"Filters"})}),e("li",{children:e(te,{})})]})})()]})]})]})};function ne(){return e("div",{className:"w-full h-screen",children:e(se,{})})}K.render(e(y.StrictMode,{children:e(Z,{children:e(ne,{})})}),document.getElementById("root"));
