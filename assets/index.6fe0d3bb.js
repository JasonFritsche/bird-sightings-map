var R=Object.defineProperty,T=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var w=(s,n,r)=>n in s?R(s,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[n]=r,f=(s,n)=>{for(var r in n||(n={}))P.call(n,r)&&w(s,r,n[r]);if(_)for(var r of _(n))W.call(n,r)&&w(s,r,n[r]);return s},b=(s,n)=>T(s,D(n));import{R as C,a as j,b as v,j as e,L as E,c as A,P as m,M as V,l as z,d as $,e as u,r as g,f as N,u as B,g as x,h as H,T as U,i as q,B as K,A as Z,v as G,k as J}from"./vendor.a392aaa8.js";const X=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const l of t)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function r(t){const l={};return t.integrity&&(l.integrity=t.integrity),t.referrerpolicy&&(l.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?l.credentials="include":t.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(t){if(t.ep)return;t.ep=!0;const l=r(t);fetch(t.href,l)}};X();const S=C({key:"allMarkers",default:[]}),k=C({key:"selectedBounds",default:{_northEast:{lat:null,lng:null},_southWest:{lat:null,lng:null}}}),L=j({key:"visibleFilters",get:({get:s})=>s(S).filter(r=>r.isVisible)}),F={bottomleft:"leaflet-bottom leaflet-left",bottomright:"leaflet-bottom leaflet-right",topleft:"leaflet-top leaflet-left",topright:"leaflet-top leaflet-right"},I=s=>{const[n,r]=v.useState(document.createElement("div")),o=s.position&&F[s.position]||F.topright;v.useEffect(()=>{const l=document.getElementsByClassName(o);r(l[0])},[o]);const t=e("div",{className:"leaflet-control leaflet-bar",children:s.children});return E.DomEvent.disableClickPropagation(n),A.createPortal(t,n)};var Y="/bird-sightings-map/assets/marker.7f572468.png";const O=({marker:s})=>e(V,{icon:new z.exports.Icon({iconUrl:Y,iconSize:[35,34],iconAnchor:[12,41]}),position:[s.lat,s.lng],children:e($,{children:u("div",{className:"flex flex-col",children:[e("div",{className:"flex flex-row",children:u("h2",{children:[e("span",{className:"font-bold",children:"Location:"})," ",s.locName]})}),e("div",{className:"flex flex-row",children:u("h2",{children:[e("span",{className:"font-bold",children:"Observed Date:"})," ",s.obsDt]})}),e("div",{className:"flex flex-row",children:u("h2",{children:[e("span",{className:"font-bold",children:"Common Name:"})," ",s.comName]})}),e("div",{className:"flex flex-row",children:u("h2",{children:[e("span",{className:"font-bold",children:"Scientific Name:"})," ",s.sciName]})})]})})},s.id);O.propTypes={marker:m.shape({id:m.node,lat:m.number,lng:m.number,locName:m.string,obsDt:m.string,comName:m.string,sciName:m.string})};const y=({isAreaSelection:s})=>{const[n,r]=g.exports.useState(null),[o,t]=N(k),l=B({areaselectstart:()=>{n&&(l.removeLayer(n),r(null))},areaselected:a=>{const h=E.rectangle(a.bounds,{color:"blue",weight:1}).addTo(l),{_bounds:d}=h;t(d),r(h)}});return g.exports.useEffect(()=>{if(!s){l.selectArea.disable();return}l.selectArea.enable(),l.selectArea.setValidate()},[s,l]),null};y.propTypes={isAreaSelection:m.bool};const Q=()=>{const[s,n]=N(k),r=B({moveend:()=>{const o=r.getBounds();n(o)}});return null},ee=(s,n)=>{const[r,o]=g.exports.useState(n);return g.exports.useEffect(()=>{const t=window.matchMedia(s);o(t==null?void 0:t.matches);const l=a=>{o(a.matches)};return(t==null?void 0:t.addEventListener)?t==null||t.addEventListener("change",l):t==null||t.addEventListener(l),()=>(t==null?void 0:t.removeEventListener)?t==null?void 0:t.removeEventListener("change",l):t==null?void 0:t.removeEventListener(l)},[s]),r},te=()=>{const[s,n]=g.exports.useState(!1),r=x(S),[o,t]=N(k),l=[30.266666,-97.73333],a=ee("(max-width:600px)",!0),h=c=>{if(c.isSelected)return e(O,{marker:c},c.id)},d=()=>s?"Hold the ctrl button to make a selection":"Click me to make a selection",i=c=>{if(a&&c){const p=c.getBounds();t(p)}};return u(H,{whenCreated:c=>i(c),className:"markercluster-map",center:l,zoom:13,scrollWheelZoom:!0,children:[e(U,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.length&&e(q,{children:r.map(c=>h(c))}),!a&&e(I,{position:"topleft",children:e("a",{onClick:()=>n(!s),children:e("div",{"data-tip":d(),className:"tooltip tooltip-right tooltip-secondary",children:e(K,{size:"30px",style:{color:"#333",backgroundColor:`${s?"#fff":"#bababa"}`}})})})}),e(I,{position:"topleft",children:e("a",{children:e("label",{htmlFor:"the-drawer",className:"drawer-button cursor-pointer",children:e(Z,{size:"30px",style:{color:"#333",backgroundColor:"#fff"}})})})}),e(y,{isAreaSelection:s}),!a&&e(y,{}),a&&e(Q,{})]})},se=()=>{const s=()=>o._northEast.lat&&o._southWest.lng?e("button",{className:"btn btn-wide btn-sm",onClick:l,children:"Search"}):e("div",{"data-tip":"Make a selection in the map, then click search",className:"tooltip tooltip-secondary",children:e("button",{disabled:!0,className:"btn btn-wide btn-sm",children:"Search"})}),[n,r]=N(S),o=x(k),t=a=>a.lat<=o._northEast.lat&&a.lng<=o._northEast.lng&&a.lng>=o._southWest.lng&&a.lat>=o._southWest.lat,l=()=>{const a=`https://api.ebird.org/v2/data/obs/geo/recent?lat=${o._northEast.lat}&lng=${o._southWest.lng}&key=nukg96b4vofk`;fetch(a).then(h=>h.json()).then(h=>{const d=h.filter(i=>t(i));d.forEach(i=>{i.isSelected=!0,i.isVisible=!0,i.id=G()}),r(d)})};return e("div",{className:"flex justify-center",children:s()})},ne=()=>{const[s,n]=N(S),r=x(L),[o,t]=g.exports.useState(!1),l=d=>{const i=s.map((c,p)=>p===d?b(f({},c),{isSelected:!c.isSelected}):c);n(i)},a=()=>{t(!o);const d=s.map(i=>b(f({},i),{isSelected:o}));n(d)},h=d=>{const i=d.target.value;if(i==null?void 0:i.length){const c=s.map(p=>p.comName.toLowerCase().startsWith(i.toLowerCase())?b(f({},p),{isVisible:!0}):b(f({},p),{isVisible:!1}));n(c)}else{const c=s.map(p=>b(f({},p),{isVisible:!0}));n(c)}};return u(v.Fragment,{children:[e("div",{className:"form-control",children:e("input",{type:"text",placeholder:"Filter",onChange:h,className:"input input-primary input-bordered"})}),e("div",{className:"form-control",children:u("label",{className:"cursor-pointer label",children:[e("span",{className:"label-text",children:"Show/Hide All"}),e("input",{type:"checkbox",checked:!o,onChange:()=>a(),className:"toggle"})]})}),e("div",{className:"h-40 overflow-y-scroll",children:r.map((d,i)=>e("div",{className:"form-control",children:u("label",{className:"cursor-pointer label",children:[e("span",{className:"label-text",children:d.comName}),e("input",{type:"checkbox",checked:s[i].isSelected,className:"checkbox checkbox-primary",onChange:()=>l(i)})]})},d.id))})]})},le=()=>{const s=x(L);return u("div",{className:"drawer drawer-mobile rounded-lg shadow bg-base-200 h-full",children:[e("input",{id:"the-drawer",type:"checkbox",className:"drawer-toggle"}),e("div",{className:"flex flex-col items-center justify-center drawer-content",children:e(te,{})}),u("div",{className:"drawer-side",children:[e("label",{htmlFor:"the-drawer",className:"drawer-overlay"}),u("ul",{className:"menu p-4 overflow-y-auto w-80 bg-base-100 text-base-content",children:[e("li",{children:e("div",{children:e("h1",{className:"font-scada text-2xl text-orange-300 text-center",children:"Bird Sightings"})})}),e("li",{children:e("div",{className:"divider",children:"Search"})}),e("li",{children:e(se,{})}),(()=>{if(s.length)return u(v.Fragment,{children:[e("li",{children:e("div",{className:"divider",children:"Results"})}),e("li",{children:e(ne,{})})]})})()]})]})]})};function re(){return e("div",{className:"w-full h-screen",children:e(le,{})})}A.render(e(v.StrictMode,{children:e(J,{children:e(re,{})})}),document.getElementById("root"));
