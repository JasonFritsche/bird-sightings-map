var L=Object.defineProperty,B=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var w=(t,s,l)=>s in t?L(t,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[s]=l,f=(t,s)=>{for(var l in s||(s={}))R.call(s,l)&&w(t,l,s[l]);if(k)for(var l of k(s))T.call(s,l)&&w(t,l,s[l]);return t},g=(t,s)=>B(t,E(s));import{R as M,a as j,P as h,j as e,M as O,l as W,b as V,c as i,r as b,d as y,u as D,L as P,e as N,f as z,T as I,C as $,B as H,v as q,g as S,h as K,i as U}from"./vendor.e9f1877d.js";const Z=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function l(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=l(r);fetch(r.href,n)}};Z();const v=M({key:"allMarkers",default:[]}),_=M({key:"selectedBounds",default:{_northEast:{lat:null,lng:null},_southWest:{lat:null,lng:null}}}),A=j({key:"visibleFilters",get:({get:t})=>t(v).filter(l=>l.isVisible)});var G="/bird-sightings-map/assets/marker.7f572468.png";const C=({marker:t})=>(console.log(t),e(O,{icon:new W.exports.Icon({iconUrl:G,iconSize:[35,34],iconAnchor:[12,41]}),position:[t.lat,t.lng],children:e(V,{children:i("div",{className:"flex flex-col",children:[e("div",{className:"flex flex-row",children:i("h2",{children:[e("span",{className:"font-bold",children:"Location:"})," ",t.locName]})}),e("div",{className:"flex flex-row",children:i("h2",{children:[e("span",{className:"font-bold",children:"Observed Date:"})," ",t.obsDt]})}),e("div",{className:"flex flex-row",children:i("h2",{children:[e("span",{className:"font-bold",children:"Common Name:"})," ",t.comName]})}),e("div",{className:"flex flex-row",children:i("h2",{children:[e("span",{className:"font-bold",children:"Scientific Name:"})," ",t.sciName]})})]})})},t.id));C.propTypes={marker:h.shape({id:h.node,lat:h.number,lng:h.number,locName:h.string,obsDt:h.string,comName:h.string,sciName:h.string})};const F=({isAreaSelection:t})=>{const[s,l]=b.exports.useState(null),[a,r]=y(_),n=D({areaselectstart:()=>{s&&(n.removeLayer(s),l(null))},areaselected:c=>{const u=P.rectangle(c.bounds,{color:"blue",weight:1}).addTo(n),{_bounds:o}=u;r(o),l(u)}});return b.exports.useEffect(()=>{if(!t){n.selectArea.disable();return}n.selectArea.enable(),n.selectArea.setValidate()},[t,n]),null};F.propTypes={isAreaSelection:h.bool};const J=()=>{const[t,s]=b.exports.useState(!1),l=N(v),a=[30.266666,-97.73333],r=c=>{if(c.isSelected)return e(C,{marker:c},c.id)};return i(z,{center:a,zoom:13,scrollWheelZoom:!0,children:[e(I,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e($,{position:"topleft",children:e("a",{onClick:()=>s(!t),children:e("div",{"data-tip":(()=>t?"Hold the ctrl button to make a selection":"Click me to make a selection")(),className:"tooltip tooltip-right tooltip-secondary",children:e(H,{size:"30px",style:{color:"#333",backgroundColor:`${t?"#fff":"#bababa"}`}})})})}),e(F,{isAreaSelection:t}),l.map(c=>r(c))]})},Q=()=>{const t=()=>a._northEast.lat&&a._southWest.lng?e("button",{className:"btn btn-wide btn-sm",onClick:r,children:"Search"}):e("div",{"data-tip":"Make a selection in the map, then click search",className:"tooltip tooltip-secondary",children:e("button",{disabled:!0,className:"btn btn-wide btn-sm",children:"Search"})}),[s,l]=y(v),a=N(_);console.log(a);const r=()=>{console.log("searching");const n=`https://api.ebird.org/v2/data/obs/geo/recent?lat=${a._northEast.lat}&lng=${a._southWest.lng}&key=nukg96b4vofk`;fetch(n).then(c=>c.json()).then(c=>{const u=c.filter(o=>{if(o.lat<=a._northEast.lat&&o.lng<=a._northEast.lng&&o.lng>=a._southWest.lng&&o.lat>=a._southWest.lat)return o});u.forEach(o=>{o.isSelected=!0,o.isVisible=!0,o.id=q()}),l(u)})};return e("div",{className:"flex justify-center",children:t()})},X=()=>{const[t,s]=y(v),l=N(A),[a,r]=b.exports.useState(!1),n=o=>{const d=t.map((p,m)=>m===o?g(f({},p),{isSelected:!p.isSelected}):p);s(d)},c=()=>{r(!a);const o=t.map(d=>g(f({},d),{isSelected:a}));s(o)},u=o=>{const d=o.target.value;if(d==null?void 0:d.length){const p=t.map(m=>m.comName.toLowerCase().startsWith(d.toLowerCase())?g(f({},m),{isVisible:!0}):g(f({},m),{isVisible:!1}));s(p)}else{const p=t.map(m=>g(f({},m),{isVisible:!0}));s(p)}};return i(S.Fragment,{children:[e("div",{className:"form-control",children:e("input",{type:"text",placeholder:"Filter",onChange:u,className:"input input-primary input-bordered"})}),e("div",{className:"form-control",children:i("label",{className:"cursor-pointer label",children:[e("span",{className:"label-text",children:"Show/Hide All"}),e("input",{type:"checkbox",checked:!a,onChange:()=>c(),className:"toggle"})]})}),e("div",{className:"h-40 overflow-y-scroll",children:l.map((o,d)=>e("div",{className:"form-control",children:i("label",{className:"cursor-pointer label",children:[e("span",{className:"label-text",children:o.comName}),e("input",{type:"checkbox",checked:t[d].isSelected,className:"checkbox checkbox-primary",onChange:()=>n(d)})]})},o.id))})]})},Y=()=>{const t=N(A);return i("div",{className:"drawer drawer-mobile rounded-lg shadow bg-base-200 h-full",children:[e("input",{id:"the-drawer",type:"checkbox",className:"drawer-toggle"}),e("div",{className:"flex flex-col items-center justify-center drawer-content",children:e(J,{})}),i("div",{className:"drawer-side",children:[e("label",{htmlFor:"the-drawer",className:"drawer-overlay"}),i("ul",{className:"menu p-4 overflow-y-auto w-80 bg-base-100 text-base-content",children:[e("li",{children:e("div",{children:e("h1",{className:"font-scada text-2xl text-orange-300 text-center",children:"Bird Sightings"})})}),e("li",{children:e("div",{className:"divider",children:"Search"})}),e("li",{children:e(Q,{})}),(()=>{if(t.length)return i(S.Fragment,{children:[e("li",{children:e("div",{className:"divider",children:"Filters"})}),e("li",{children:e(X,{})})]})})()]})]})]})};function ee(){return e("div",{className:"w-full h-screen",children:e(Y,{})})}K.render(e(S.StrictMode,{children:e(U,{children:e(ee,{})})}),document.getElementById("root"));
