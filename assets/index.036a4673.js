var T=Object.defineProperty,W=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var B=(s,n,o)=>n in s?T(s,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[n]=o,b=(s,n)=>{for(var o in n||(n={}))V.call(n,o)&&B(s,o,n[o]);if(A)for(var o of A(n))z.call(n,o)&&B(s,o,n[o]);return s},v=(s,n)=>W(s,j(n));import{R as _,a as $,b as N,j as e,L,c as F,P as m,M as H,l as U,d as q,e as d,r as g,f as x,u as P,g as S,h as K,T as Z,i as G,B as J,A as X,v as Y,k as Q}from"./vendor.a392aaa8.js";const ee=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const l of t)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(t){const l={};return t.integrity&&(l.integrity=t.integrity),t.referrerpolicy&&(l.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?l.credentials="include":t.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(t){if(t.ep)return;t.ep=!0;const l=o(t);fetch(t.href,l)}};ee();const y=_({key:"allMarkers",default:[]}),te=_({key:"position",default:null}),w=_({key:"selectedBounds",default:{_northEast:{lat:null,lng:null},_southWest:{lat:null,lng:null}}}),I=$({key:"visibleFilters",get:({get:s})=>s(y).filter(o=>o.isVisible)});var se="/bird-sightings-map/assets/logo.4b75d2ab.png";const O={bottomleft:"leaflet-bottom leaflet-left",bottomright:"leaflet-bottom leaflet-right",topleft:"leaflet-top leaflet-left",topright:"leaflet-top leaflet-right"},R=s=>{const[n,o]=N.useState(document.createElement("div")),r=s.position&&O[s.position]||O.topright;N.useEffect(()=>{const l=document.getElementsByClassName(r);o(l[0])},[r]);const t=e("div",{className:"leaflet-control leaflet-bar",children:s.children});return L.DomEvent.disableClickPropagation(n),F.createPortal(t,n)};var ne="/bird-sightings-map/assets/marker.7f572468.png";const D=({marker:s})=>e(H,{icon:new U.exports.Icon({iconUrl:ne,iconSize:[35,34],iconAnchor:[12,41]}),position:[s.lat,s.lng],children:e(q,{children:d("div",{className:"flex flex-col",children:[e("div",{className:"flex flex-row",children:d("h2",{children:[e("span",{className:"font-bold",children:"Location:"})," ",s.locName]})}),e("div",{className:"flex flex-row",children:d("h2",{children:[e("span",{className:"font-bold",children:"Observed Date:"})," ",s.obsDt]})}),e("div",{className:"flex flex-row",children:d("h2",{children:[e("span",{className:"font-bold",children:"Common Name:"})," ",s.comName]})}),e("div",{className:"flex flex-row",children:d("h2",{children:[e("span",{className:"font-bold",children:"Scientific Name:"})," ",s.sciName]})})]})})},s.id);D.propTypes={marker:m.shape({id:m.node,lat:m.number,lng:m.number,locName:m.string,obsDt:m.string,comName:m.string,sciName:m.string})};const C=({isAreaSelection:s})=>{const[n,o]=g.exports.useState(null),[r,t]=x(w),l=P({areaselectstart:()=>{n&&(l.removeLayer(n),o(null))},areaselected:i=>{const h=L.rectangle(i.bounds,{color:"blue",weight:1}).addTo(l),{_bounds:c}=h;t(c),o(h)}});return g.exports.useEffect(()=>{if(!s){l.selectArea.disable();return}l.selectArea.enable(),l.selectArea.setValidate()},[s,l]),null};C.propTypes={isAreaSelection:m.bool};const le=()=>{const[s,n]=x(w),o=P({moveend:()=>{const r=o.getBounds();n(r)}});return null},oe=(s,n)=>{const[o,r]=g.exports.useState(n);return g.exports.useEffect(()=>{const t=window.matchMedia(s);r(t==null?void 0:t.matches);const l=i=>{r(i.matches)};return(t==null?void 0:t.addEventListener)?t==null||t.addEventListener("change",l):t==null||t.addEventListener(l),()=>(t==null?void 0:t.removeEventListener)?t==null?void 0:t.removeEventListener("change",l):t==null?void 0:t.removeEventListener(l)},[s]),o},re=()=>{const[s,n]=g.exports.useState(!1),o=S(y),[r,t]=x(w),[l,i]=x(te);g.exports.useEffect(()=>{window.navigator.geolocation?window.navigator.geolocation.getCurrentPosition(h,c):i([38.266666,-91.73333])},[]);const h=u=>{const{latitude:M,longitude:E}=u.coords;console.log(M,E),i([M,E])},c=()=>{i([38.266666,-91.73333])},a=oe("(max-width:600px)",!0),p=u=>{if(u.isSelected)return e(D,{marker:u},u.id)},f=()=>s?"Hold the ctrl button to make a selection":"Click me to make a selection",k=u=>{if(a&&u){const M=u.getBounds();t(M)}};return e(N.Fragment,{children:l&&d(K,{whenCreated:u=>k(u),className:"markercluster-map",center:l,zoom:13,scrollWheelZoom:!0,children:[e(Z,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),o.length&&e(G,{children:o.map(u=>p(u))}),!a&&e(R,{position:"topleft",children:e("a",{onClick:()=>n(!s),children:e("div",{"data-tip":f(),className:"tooltip tooltip-right tooltip-secondary",children:e(J,{size:"30px",style:{color:"#333",backgroundColor:`${s?"#fff":"#bababa"}`}})})})}),e(R,{position:"topleft",children:e("a",{children:e("label",{htmlFor:"the-drawer",className:"drawer-button cursor-pointer",children:e(X,{size:"30px",style:{color:"#333",backgroundColor:"#fff"}})})})}),e(C,{isAreaSelection:s}),!a&&e(C,{}),a&&e(le,{})]})})},ae=()=>{const s=()=>r._northEast.lat&&r._southWest.lng?e("button",{className:"btn btn-wide btn-sm",onClick:l,children:"Search"}):e("div",{"data-tip":"Make a selection in the map, then click search",className:"tooltip tooltip-secondary",children:e("button",{disabled:!0,className:"btn btn-wide btn-sm",children:"Search"})}),[n,o]=x(y),r=S(w),t=i=>i.lat<=r._northEast.lat&&i.lng<=r._northEast.lng&&i.lng>=r._southWest.lng&&i.lat>=r._southWest.lat,l=()=>{const i=`https://api.ebird.org/v2/data/obs/geo/recent?lat=${r._northEast.lat}&lng=${r._southWest.lng}&key=nukg96b4vofk`;fetch(i).then(h=>h.json()).then(h=>{const c=h.filter(a=>t(a));c.forEach(a=>{a.isSelected=!0,a.isVisible=!0,a.id=Y()}),o(c)})};return e("div",{className:"flex justify-center",children:s()})},ie=()=>{const[s,n]=x(y),o=S(I),[r,t]=g.exports.useState(!1),l=c=>{const a=s.map((p,f)=>f===c?v(b({},p),{isSelected:!p.isSelected}):p);n(a)},i=()=>{t(!r);const c=s.map(a=>v(b({},a),{isSelected:r}));n(c)},h=c=>{const a=c.target.value;if(a==null?void 0:a.length){const p=s.map(f=>f.comName.toLowerCase().startsWith(a.toLowerCase())?v(b({},f),{isVisible:!0}):v(b({},f),{isVisible:!1}));n(p)}else{const p=s.map(f=>v(b({},f),{isVisible:!0}));n(p)}};return d(N.Fragment,{children:[e("div",{className:"form-control",children:e("input",{type:"text",placeholder:"Filter",onChange:h,className:"input input-primary input-bordered"})}),e("div",{className:"form-control",children:d("label",{className:"cursor-pointer label",children:[e("span",{className:"label-text",children:"Show/Hide All"}),e("input",{type:"checkbox",checked:!r,onChange:()=>i(),className:"toggle"})]})}),e("div",{className:"h-40 overflow-y-scroll",children:o.map((c,a)=>e("div",{className:"form-control",children:d("label",{className:"cursor-pointer label",children:[e("span",{className:"label-text",children:c.comName}),e("input",{type:"checkbox",checked:s[a].isSelected,className:"checkbox checkbox-primary",onChange:()=>l(a)})]})},c.id))})]})},ce=()=>{const s=S(I);return d("div",{className:"drawer drawer-mobile rounded-lg shadow bg-base-200 h-full",children:[e("input",{id:"the-drawer",type:"checkbox",className:"drawer-toggle"}),e("div",{className:"flex flex-col items-center justify-center drawer-content",children:e(re,{})}),d("div",{className:"drawer-side",children:[e("label",{htmlFor:"the-drawer",className:"drawer-overlay"}),d("ul",{className:"menu p-4 overflow-y-auto w-80 bg-base-100 text-base-content",children:[e("li",{children:e("div",{children:e("img",{src:se,alt:"Bird Sightings Map logo"})})}),e("li",{children:e(ae,{})}),(()=>{if(s.length)return d(N.Fragment,{children:[e("li",{children:e("div",{className:"divider",children:"Results"})}),e("li",{children:e(ie,{})})]})})()]})]})]})};function de(){return e("div",{className:"w-full h-screen",children:e(ce,{})})}F.render(e(N.StrictMode,{children:e(Q,{children:e(de,{})})}),document.getElementById("root"));
