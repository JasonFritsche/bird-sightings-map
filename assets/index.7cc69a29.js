var R=Object.defineProperty,T=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var w=(s,l,r)=>l in s?R(s,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[l]=r,f=(s,l)=>{for(var r in l||(l={}))P.call(l,r)&&w(s,r,l[r]);if(_)for(var r of _(l))W.call(l,r)&&w(s,r,l[r]);return s},g=(s,l)=>T(s,D(l));import{R as C,a as j,b as v,j as e,L as E,c as A,P as h,M as V,l as z,d as $,e as u,r as b,f as N,u as L,g as x,h as H,T as U,i as q,B as K,A as Z,v as G,k as J}from"./vendor.a392aaa8.js";const X=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function r(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?n.credentials="include":t.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(t){if(t.ep)return;t.ep=!0;const n=r(t);fetch(t.href,n)}};X();const S=C({key:"allMarkers",default:[]}),y=C({key:"selectedBounds",default:{_northEast:{lat:null,lng:null},_southWest:{lat:null,lng:null}}}),B=j({key:"visibleFilters",get:({get:s})=>s(S).filter(r=>r.isVisible)}),F={bottomleft:"leaflet-bottom leaflet-left",bottomright:"leaflet-bottom leaflet-right",topleft:"leaflet-top leaflet-left",topright:"leaflet-top leaflet-right"},O=s=>{const[l,r]=v.useState(document.createElement("div")),o=s.position&&F[s.position]||F.topright;v.useEffect(()=>{const n=document.getElementsByClassName(o);r(n[0])},[o]);const t=e("div",{className:"leaflet-control leaflet-bar",children:s.children});return E.DomEvent.disableClickPropagation(l),A.createPortal(t,l)};var Y="/bird-sightings-map/assets/marker.7f572468.png";const I=({marker:s})=>e(V,{icon:new z.exports.Icon({iconUrl:Y,iconSize:[35,34],iconAnchor:[12,41]}),position:[s.lat,s.lng],children:e($,{children:u("div",{className:"flex flex-col",children:[e("div",{className:"flex flex-row",children:u("h2",{children:[e("span",{className:"font-bold",children:"Location:"})," ",s.locName]})}),e("div",{className:"flex flex-row",children:u("h2",{children:[e("span",{className:"font-bold",children:"Observed Date:"})," ",s.obsDt]})}),e("div",{className:"flex flex-row",children:u("h2",{children:[e("span",{className:"font-bold",children:"Common Name:"})," ",s.comName]})}),e("div",{className:"flex flex-row",children:u("h2",{children:[e("span",{className:"font-bold",children:"Scientific Name:"})," ",s.sciName]})})]})})},s.id);I.propTypes={marker:h.shape({id:h.node,lat:h.number,lng:h.number,locName:h.string,obsDt:h.string,comName:h.string,sciName:h.string})};const M=({isAreaSelection:s})=>{const[l,r]=b.exports.useState(null),[o,t]=N(y),n=L({areaselectstart:()=>{l&&(n.removeLayer(l),r(null))},areaselected:a=>{const c=E.rectangle(a.bounds,{color:"blue",weight:1}).addTo(n),{_bounds:d}=c;t(d),r(c)}});return b.exports.useEffect(()=>{if(!s){n.selectArea.disable();return}n.selectArea.enable(),n.selectArea.setValidate()},[s,n]),null};M.propTypes={isAreaSelection:h.bool};const Q=()=>{const[s,l]=N(y),r=L({moveend:()=>{const o=r.getBounds();l(o)}});return null},ee=(s,l)=>{const[r,o]=b.exports.useState(l);return b.exports.useEffect(()=>{const t=window.matchMedia(s);o(t==null?void 0:t.matches);const n=a=>{o(a.matches)};return(t==null?void 0:t.addEventListener)?t==null||t.addEventListener("change",n):t==null||t.addEventListener(n),()=>(t==null?void 0:t.removeEventListener)?t==null?void 0:t.removeEventListener("change",n):t==null?void 0:t.removeEventListener(n)},[s]),r},te=()=>{const[s,l]=b.exports.useState(!1),r=x(S),o=[30.266666,-97.73333],t=ee("(max-width:600px)",!0),n=c=>{if(c.isSelected)return e(I,{marker:c},c.id)},a=()=>s?"Hold the ctrl button to make a selection":"Click me to make a selection";return u(H,{className:"markercluster-map",center:o,zoom:13,scrollWheelZoom:!0,children:[e(U,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.length&&e(q,{children:r.map(c=>n(c))}),!t&&e(O,{position:"topleft",children:e("a",{onClick:()=>l(!s),children:e("div",{"data-tip":a(),className:"tooltip tooltip-right tooltip-secondary",children:e(K,{size:"30px",style:{color:"#333",backgroundColor:`${s?"#fff":"#bababa"}`}})})})}),e(O,{position:"topleft",children:e("a",{children:e("label",{htmlFor:"the-drawer",className:"drawer-button cursor-pointer",children:e(Z,{size:"30px",style:{color:"#333",backgroundColor:"#fff"}})})})}),e(M,{isAreaSelection:s}),!t&&e(M,{}),t&&e(Q,{})]})},se=()=>{const s=()=>o._northEast.lat&&o._southWest.lng?e("button",{className:"btn btn-wide btn-sm",onClick:n,children:"Search"}):e("div",{"data-tip":"Make a selection in the map, then click search",className:"tooltip tooltip-secondary",children:e("button",{disabled:!0,className:"btn btn-wide btn-sm",children:"Search"})}),[l,r]=N(S),o=x(y),t=a=>a.lat<=o._northEast.lat&&a.lng<=o._northEast.lng&&a.lng>=o._southWest.lng&&a.lat>=o._southWest.lat,n=()=>{const a=`https://api.ebird.org/v2/data/obs/geo/recent?lat=${o._northEast.lat}&lng=${o._southWest.lng}&key=nukg96b4vofk`;fetch(a).then(c=>c.json()).then(c=>{const d=c.filter(i=>t(i));d.forEach(i=>{i.isSelected=!0,i.isVisible=!0,i.id=G()}),r(d)})};return e("div",{className:"flex justify-center",children:s()})},le=()=>{const[s,l]=N(S),r=x(B),[o,t]=b.exports.useState(!1),n=d=>{const i=s.map((p,m)=>m===d?g(f({},p),{isSelected:!p.isSelected}):p);l(i)},a=()=>{t(!o);const d=s.map(i=>g(f({},i),{isSelected:o}));l(d)},c=d=>{const i=d.target.value;if(i==null?void 0:i.length){const p=s.map(m=>m.comName.toLowerCase().startsWith(i.toLowerCase())?g(f({},m),{isVisible:!0}):g(f({},m),{isVisible:!1}));l(p)}else{const p=s.map(m=>g(f({},m),{isVisible:!0}));l(p)}};return u(v.Fragment,{children:[e("div",{className:"form-control",children:e("input",{type:"text",placeholder:"Filter",onChange:c,className:"input input-primary input-bordered"})}),e("div",{className:"form-control",children:u("label",{className:"cursor-pointer label",children:[e("span",{className:"label-text",children:"Show/Hide All"}),e("input",{type:"checkbox",checked:!o,onChange:()=>a(),className:"toggle"})]})}),e("div",{className:"h-40 overflow-y-scroll",children:r.map((d,i)=>e("div",{className:"form-control",children:u("label",{className:"cursor-pointer label",children:[e("span",{className:"label-text",children:d.comName}),e("input",{type:"checkbox",checked:s[i].isSelected,className:"checkbox checkbox-primary",onChange:()=>n(i)})]})},d.id))})]})},ne=()=>{const s=x(B);return u("div",{className:"drawer rounded-lg shadow bg-base-200 h-full",children:[e("input",{id:"the-drawer",type:"checkbox",className:"drawer-toggle"}),e("div",{className:"flex flex-col items-center justify-center drawer-content",children:e(te,{})}),u("div",{className:"drawer-side",children:[e("label",{htmlFor:"the-drawer",className:"drawer-overlay"}),u("ul",{className:"menu p-4 overflow-y-auto w-80 bg-base-100 text-base-content",children:[e("li",{children:e("div",{children:e("h1",{className:"font-scada text-2xl text-orange-300 text-center",children:"Bird Sightings"})})}),e("li",{children:e("div",{className:"divider",children:"Search"})}),e("li",{children:e(se,{})}),(()=>{if(s.length)return u(v.Fragment,{children:[e("li",{children:e("div",{className:"divider",children:"Filters"})}),e("li",{children:e(le,{})})]})})()]})]})]})};function re(){return e("div",{className:"w-full h-screen",children:e(ne,{})})}A.render(e(v.StrictMode,{children:e(J,{children:e(re,{})})}),document.getElementById("root"));
